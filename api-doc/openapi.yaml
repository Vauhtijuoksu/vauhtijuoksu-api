openapi: 3.0.3
info:
  version: 0.0.7
  title: Vauhtijuoksu API
servers:
  - url: https://api.dev.vauhtijuoksu.fi
paths:
  /donations:
    get:
      description: >
        Get all donations with one request. List of individual donations with
        metadata.
      responses:
        '200':
          $ref: '#/components/responses/DonationsAllOk'
    post:
      description: Add a new donation object.
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DonationInput'
      responses:
        '200':
          $ref: '#/components/responses/OkReturnId'
  /donations/{donationId}:
    parameters:
      - name: donationId
        in: path
        required: true
        description: Donation id (uuid).
        schema:
          type: string
          format: uuid
    get:
      description: Get donation by id.
      responses:
        '200':
          $ref: '#/components/responses/DonationsOk'
    patch:
      description: Patch donation data.
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DonationPatch'
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
    delete:
      description: Delete donation.
      security:
        - basicAuth: []
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
  /gamedata:
    get:
      description: >
        Get list of all game data. List of games that are scheduled for the event.

      responses:
        '200':
          $ref: '#/components/responses/GameDataAllOk'
    post:
      description: Add a new gamedata object.
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GameDataInput'
      responses:
        '200':
          $ref: '#/components/responses/OkReturnId'
  /gamedata/{gamedataId}:
    parameters:
      - name: gamedataId
        in: path
        required: true
        description: Game data id (uuid).
        schema:
          type: string
          format: uuid
    get:
      description: Get game data by id.
      responses:
        '200':
          $ref: '#/components/responses/GameDataOk'
    patch:
      description: Patch game data.
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GameDataPatch'
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
    delete:
      description: Delete game data.
      security:
        - basicAuth: []
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
  /stream_metadata:
    get:
      description: >
        Get stream metadata. This is meant for misc information shown on stream
        layout
      responses:
        '200':
          $ref: '#/components/responses/StreamMetadataOk'
    patch:
      description: Patch stream metadata.
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StreamMetadata'
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
  /player_info:
    get:
      description: >
        Get player info. This is used for displaying messages for player when they
        are on stream.
      responses:
        '200':
          $ref: '#/components/responses/PlayerInfoOk'
    patch:
      description: Patch player info.
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlayerInfo'
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
  /incentives:
    get:
      description: >
        Get list of all incentives. These are incentives for donating money to charity for
        exchange to influence what happens on stream.
      responses:
        '200':
          $ref: '#/components/responses/IncentivesAllOk'
    post:
      description: Add a new incentive object.
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncentiveInput'
      responses:
        '200':
          $ref: '#/components/responses/OkReturnId'
  /incentives/{incentiveId}:
    parameters:
      - name: incentiveId
        in: path
        required: true
        description: Incentive id (uuid).
        schema:
          type: string
          format: uuid
    get:
      description: Get incentive by id.
      responses:
        '200':
          $ref: '#/components/responses/IncentiveOk'
    patch:
      description: Patch incentive
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncentivePatch'
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
    delete:
      description: Delete incentive
      security:
        - basicAuth: []
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
  /incentive_codes:
    get:
      description: >
        Get list of all incentive codes. These codes are used for pasting them on
        donation message. This links donation to insentive.
      responses:
        '200':
          $ref: '#/components/responses/IncentiveCodesAllOk'
    post:
      description: Add a new incentive code object.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncentiveCodeInput'
      responses:
        '200':
          $ref: '#/components/responses/OkReturnCode'
  /incentive_codes/{incentiveCode}:
    parameters:
      - name: incentiveCode
        in: path
        required: true
        description: incentive code.
        schema:
          type: string
    get:
      description: Get incentive codes by code.
      responses:
        '200':
          $ref: '#/components/responses/IncentiveCodesOk'
    patch:
      description: Patch incentive code
      security:
        - basicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncentiveCodePatch'
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'
    delete:
      description: Delete incentive code
      security:
        - basicAuth: []
      responses:
        '200':
          $ref: '#/components/responses/OkEmpty'

components:
  responses:
    OkEmpty:
      description: Return empty 200
    OkReturnId:
      description: Return id when POST is successful
      content:
        application/json:
          schema:
            properties:
              id:
                type: string
                format: uuid
    OkReturnCode:
      description: Return incentive code when POST is successful
      content:
        application/json:
          schema:
            properties:
              code:
                type: string
    DonationsAllOk:
      description: List of donations
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Donations'
    DonationsOk:
      description: Donation by id
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/DonationOutput'
    GameDataAllOk:
      description: List of game data
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/GameDataAll'
    GameDataOk:
      description: Game data by id
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/GameDataOutput'
    StreamMetadataOk:
      description: Stream metadata
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/StreamMetadata'
    PlayerInfoOk:
      description: Player info
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/PlayerInfo'
    IncentivesAllOk:
      description: List of incentives
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Incentives'
    IncentiveOk:
      description: Incentives by id (uuid)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/IncentiveOutput'
    IncentiveCodesAllOk:
      description: List of incentive code data
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/IncentiveCodes'
    IncentiveCodesOk:
      description: Incentice data by code
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/IncentiveCodeOutput'
  schemas:
    Donation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        name:
          type: string
        message:
          type: string
        read:
          type: boolean
          default: false
        amount:
          type: number
      required:
        - id
        - name
        - timestamp
        - amount
      example:
        id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929
        timestamp: '2021-09-21T15:05:47.000+00:00'
        name: jsloth
        message: ota t√§√§ :D ü§îü§î
        read: false
        amount: 10
    Donations:
      type: array
      items:
        $ref: '#/components/schemas/Donation'
      example:
        - id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929
          timestamp: '2021-09-21T15:05:47.000+00:00'
          name: jsloth
          message: ota t√§√§ :D ü§îü§î
          read: true
          amount: 10
        - id: 7c28df04-b9d2-4ebe-bd33-58c9b290d930
          timestamp: '2021-09-21T15:05:50.000+00:00'
          name: luuranki
          message: 'mee t√§nne: t√∂ihin :))))))))'
          read: false
          amount: 5
    DonationInput:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        name:
          type: string
        message:
          type: string
        read:
          type: boolean
          default: false
        amount:
          type: number
      required:
        - timestamp
        - name
        - amount
      example:
        timestamp: '2021-09-21T15:05:47.000+00:00'
        name: jsloth
        message: ota t√§√§ :D ü§îü§î
        read: false
        amount: 10
    DonationPatch:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        name:
          type: string
        message:
          type: string
        read:
          type: boolean
          default: false
        amount:
          type: number
      example:
        name: jsloth
        message: ota t√§√§ :D ü§îü§î
    DonationOutput:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        name:
          type: string
        message:
          type: string
        read:
          type: boolean
          default: false
        amount:
          type: number
      required:
        - timestamp
        - name
        - amount
      example:
        timestamp: '2021-09-21T15:05:47.000+00:00'
        name: jsloth
        message: ota t√§√§ :D ü§îü§î
        read: false
        amount: 10
    GameData:
      type: object
      properties:
        id:
          type: string
          format: uuid
        game:
          type: string
        player:
          type: string
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        category:
          type: string
        device:
          type: string
        published:
          type: string
        vod_link:
          type: string
        img_filename:
          type: string
        player_twitch:
          type: string
      required:
        - id
        - game
        - player
        - start_time
        - end_time
        - category
        - device
        - published
      example:
        id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929
        game: Tetris
        player: jsloth
        start_time: '2021-09-21T15:05:47.000+00:00'
        end_time: '2021-09-21T16:05:47.000+00:00'
        category: any%
        device: PC
        published: '1970'
        vod_link: https://www.youtube.com/watch?v=dQw4w9WgXcQ
        img_filename: tetris.png
        player_twitch: jiisloth
    GameDataAll:
      type: array
      items:
        $ref: '#/components/schemas/GameData'
      example:
        - id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929
          game: Tetris
          player: jsloth
          start_time: '2021-09-21T15:05:47.000+00:00'
          end_time: '2021-09-21T16:05:47.000+00:00'
          category: any%
          device: PC
          published: '1970'
          vod_link: https://www.youtube.com/watch?v=dQw4w9WgXcQ
          img_filename: tetris.png
          player_twitch: jiisloth
        - id: 6c28df04-b9d2-4ebe-bd33-58c9b290d930
          game: Tetris2
          player: jsloth
          start_time: '2021-09-21T15:07:47.000+00:00'
          end_time: '2021-09-21T16:08:47.000+00:00'
          category: any% no t
          device: PC
          published: '1971'
          vod_link: https://www.youtube.com/watch?v=dQw4w9WgXcQ
          img_filename: tetris.png
          player_twitch: jiisloth
    GameDataInput:
      type: object
      properties:
        game:
          type: string
        player:
          type: string
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        category:
          type: string
        device:
          type: string
        published:
          type: string
        vod_link:
          type: string
        img_filename:
          type: string
        player_twitch:
          type: string
      required:
        - game
        - player
        - start_time
        - end_time
        - category
        - device
        - published
      example:
        game: Tetris
        player: jsloth
        start_time: '2021-09-21T15:05:47.000+00:00'
        end_time: '2021-09-21T16:05:47.000+00:00'
        category: any%
        device: PC
        published: '1970'
        vod_link: https://www.youtube.com/watch?v=dQw4w9WgXcQ
        img_filename: tetris.png
        player_twitch: jiisloth
    GameDataPatch:
      type: object
      properties:
        game:
          type: string
        player:
          type: string
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        category:
          type: string
        device:
          type: string
        published:
          type: string
        vod_link:
          type: string
        img_filename:
          type: string
        player_twitch:
          type: string
      example:
        game: Tetris
        device: PC
        published: '1970'
        player_twitch: jiisloth
    GameDataOutput:
      type: object
      properties:
        game:
          type: string
        player:
          type: string
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        category:
          type: string
        device:
          type: string
        published:
          type: string
        vod_link:
          type: string
        img_filename:
          type: string
        player_twitch:
          type: string
      required:
        - game
        - player
        - start_time
        - end_time
        - category
        - device
        - published
      example:
        game: Tetris
        player: jsloth
        start_time: '2021-09-21T15:05:47.000+00:00'
        end_time: '2021-09-21T16:05:47.000+00:00'
        category: any%
        device: PC
        published: '1970'
        vod_link: https://www.youtube.com/watch?v=dQw4w9WgXcQ
        img_filename: tetris.png
        player_twitch: jiisloth
    StreamMetadata:
      type: object
      properties:
        donation_goal:
          type: integer
        current_game_id:
          type: string
          format: uuid
        donatebar_info:
          type: array
          items:
            type: string
        counters:
          type: array
          items:
            type: integer
      required:
        - donation_goal
      example:
        donation_goal: 10000
        current_game_id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929
        donatebar_info:
          - lahjota rahhaa
          - mee t√∂ihi :D
        counters:
          - 1
          - 7
          - 6
          - 9
    PlayerInfo:
      type: object
      properties:
        message:
          type: string
      example:
        message: Lahjoituksia luettavana!!
    Incentive:
      type: object
      properties:
        id:
          type: string
          format: uuid
        game:
          type: string
        title:
          type: string
        end_time:
          type: string
          format: date-time
        type:
          type: string
        open_char_limit:
          type: string
        updrade_parameters:
          items:
            type: integer
        option_parameters:
          items:
            type: string
      required:
        - id
        - title
        - type
      example:
        id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929
        game: Tetris2
        title: Tetrispakikan nimi
        end_time: '2021-09-21T19:08:47.000+00:00'
        type: open
        open_char_limit: 10
        info: Nime√§ tetrispalikka poggers
    Incentives:
      type: array
      items:
        $ref: '#/components/schemas/Incentive'
      example:
        - id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929
          game: Tetris
          title: Ei py√∂rimist√§
          end_time: '2021-09-21T16:08:47.000+00:00'
          type: upgrade
          upgrade_parameters:
            - 200
            - 300
          info: Ei saa py√∂ritt√§√§ palikoita
        - id: 6c28df04-b9d2-4ebe-bd33-58c9b290d930
          game: Tetris2
          title: silm√§t kii
          end_time: '2021-09-21T19:08:47.000+00:00'
          type: option
          option_parameters:
            - kissa
            - koira
          info: Saa kattoa vaan kissoja tai koiria
        - id: 6c28df04-b9d2-4ebe-bd33-58c9b290d931
          game: Tetris2
          title: Tetrispakikan nimi
          end_time: '2021-09-21T19:08:47.000+00:00'
          type: open
          open_char_limit: 10
          info: Nime√§ tetrispalikka poggers
    IncentiveInput:
      type: object
      properties:
        game:
          type: string
        title:
          type: string
        end_time:
          type: string
          format: date-time
        type:
          type: string
        open_char_limit:
          type: string
        updrade_parameters:
          items:
            type: integer
        option_parameters:
          items:
            type: string
      required:
        - title
        - type
      example:
        game: Tetris2
        title: Tetrispakikan nimi
        end_time: '2021-09-21T19:08:47.000+00:00'
        type: open
        open_char_limit: 10
        info: Nime√§ tetrispalikka poggers
    IncentivePatch:
      type: object
      properties:
        game:
          type: string
        title:
          type: string
        end_time:
          type: string
          format: date-time
        type:
          type: string
        open_char_limit:
          type: string
        updrade_parameters:
          items:
            type: integer
        option_parameters:
          items:
            type: string
      example:
        end_time: '2021-09-21T19:08:47.000+00:00'
        open_char_limit: 10
        info: Nime√§ tetrispalikka poggers
    IncentiveOutput:
      type: object
      properties:
        game:
          type: string
        title:
          type: string
        end_time:
          type: string
          format: date-time
        type:
          type: string
        open_char_limit:
          type: string
        updrade_parameters:
          items:
            type: integer
        option_parameters:
          items:
            type: string
      required:
        - title
        - type
      example:
        game: Tetris2
        title: Tetrispakikan nimi
        end_time: '2021-09-21T19:08:47.000+00:00'
        type: open
        open_char_limit: 10
        info: Nime√§ tetrispalikka poggers
    IncentiveCodes:
      type: array
      items:
        type: object
        properties:
          code:
            type: string
          id:
            type: string
            format: uuid
          parameters:
            type: string
        required:
          - code
          - id
      example:
        - code: XY123
          id: 6c28df04-b9d2-4ebe-bd33-58c9b290d931
          parameter: kalle tetr
        - code: XY124
          id: 6c28df04-b9d2-4ebe-bd33-58c9b290d930
          parameter: kissa
        - code: XY125
          id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929
    IncentiveCodeInput:
      type: object
      properties:
        id:
          type: string
          format: uuid
        parameters:
          type: string
      required:
        - id
      example:
        id: 6c28df04-b9d2-4ebe-bd33-58c9b290d931
        parameter: kalle tetr
    IncentiveCodePatch:
      type: object
      properties:
        id:
          type: string
          format: uuid
        parameters:
          type: string
      example:
        parameter: kalle tetr
    IncentiveCodeOutput:
      type: array
      items:
        type: object
        properties:
          code:
            type: string
          id:
            type: string
            format: uuid
          parameters:
            type: string
        required:
          - code
          - id
      example:
        - code: XY123
          id: 6c28df04-b9d2-4ebe-bd33-58c9b290d931
          parameter: kalle tetr
        - code: XY123
          id: 6c28df04-b9d2-4ebe-bd33-58c9b290d930
          parameter: kissa
        - code: XY123
          id: 6c28df04-b9d2-4ebe-bd33-58c9b290d929

  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
